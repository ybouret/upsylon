
ADD_EXECUTABLE(test-mini-lzo ../y/codec/lzo/testmini.c)
TARGET_LINK_Y(test-mini-lzo)
ADD_CUSTOM_COMMAND(
TARGET             test-mini-lzo
POST_BUILD COMMAND test-mini-lzo
COMMENT            "Testing miniLZO"
)

FILE(GLOB srcs test-*.cpp)

ADD_EXECUTABLE(test-main main.cpp ${srcs} support.hpp)
TARGET_LINK_Y(test-main)

ADD_LIBRARY(module MODULE module.cpp)


ENABLE_TESTING()
ADD_TEST(Platform    test-main platform)
ADD_TEST(Types       test-main types)
ADD_TEST(Lockable    test-main lockable)
ADD_TEST(Swap        test-main swap)
ADD_TEST(Zset        test-main zset)
ADD_TEST(AtExit      test-main at_exit)
ADD_TEST(Sys         test-main sys)
ADD_TEST(Code        test-main code)
ADD_TEST(Bits        test-main bits)
ADD_TEST(Chunk       test-main chunk)
ADD_TEST(Alloc       test-main alloc)
ADD_TEST(Core        test-main core)
ADD_TEST(Arena       test-main arena)
ADD_TEST(Blocks      test-main blocks)
ADD_Test(Slab        test-main slab)
ADD_TEST(Primality   test-main blocks)
ADD_TEST(Object0     test-main object0)
ADD_TEST(ObjectY     test-main objectY)
ADD_TEST(Slice       test-main slice)
ADD_TEST(Carver      test-main carver)
ADD_TEST(Pooled      test-main pooled)
ADD_TEST(Buffers     test-main buffers)
ADD_TEST(CSlot       test-main cslot)
ADD_TEST(String      test-main string)
ADD_TEST(StrConv     test-main string_convert s 123456 s 0xff i -23 i 908 s 0x34)
ADD_TEST(TmpName     test-main tmpname)
ADD_TEST(Nugget      test-main nugget)
ADD_TEST(Nuggets     test-main nuggets)
ADD_TEST(Vein        test-main vein)
ADD_TEST(Ptr         test-main ptr)
ADD_TEST(Slots       test-main slots)
ADD_TEST(Sequence    test-main sequence)
ADD_TEST(Pipe        test-main pipe)
ADD_TEST(Arrays      test-main arrays)
ADD_TEST(Dyadic      test-main dyadic)
ADD_TEST(Endian      test-main endian)
ADD_TEST(Env         test-main env)
ADD_TEST(Parallel    test-main parallel)
ADD_TEST(Threads     test-main threads)
ADD_TEST(SIMD        test-main simd)
ADD_TEST(Complex     test-main complex)
ADD_TEST(MPN         test-main mpn)
ADD_TEST(MPZ         test-main mpz)
ADD_TEST(MPZ         test-main mpq)

ADD_TEST(hashing     test-main hashing)
ADD_TEST(hmac        test-main hmac)
ADD_TEST(kr_sc       test-main kr_sc)
ADD_TEST(kr_bc       test-main kr_bc)

ADD_TEST(ostreams    test-main ostreams)
ADD_TEST(istreams    test-main istreams)
ADD_TEST(xbitrev     test-main xbitrev 0.0)
ADD_TEST(FFT         test-main fft)
ADD_TEST(Sort        test-main sort)
ADD_TEST(Unique      test-main unique)
ADD_TEST(Associative test-main associative)
ADD_TEST(Set         test-main set)
ADD_TEST(Map         test-main map)
ADD_TEST(Matrix      test-main matrix)
ADD_TEST(Functor     test-main functor)
ADD_TEST(vfs         test-main vfs .)
ADD_TEST(nwsrt       test-main nwsrt)
ADD_TEST(Triplet     test-main triplet)
ADD_TEST(Points      test-main points)
ADD_TEST(Tuple       test-main tuple)
ADD_TEST(Release     test-main release)
ADD_TEST(Base64      test-main base64 NULL)
ADD_TEST(Spec        test-main spec)
ADD_TEST(LZO         test-main lzo)
ADD_TEST(IObits      test-main iobits)
ADD_TEST(MTF         test-main  mtf)
ADD_TEST(Delta       test-main  delta)
ADD_TEST(ASF         test-main  asf)
ADD_TEST(Digest      test-main  digest)
ADD_TEST(Locate      test-main  locate)
ADD_TEST(Ppty        test-main  ppty)
ADD_TEST(Progress    test-main  progress)
ADD_TEST(Sobol       test-main  sobol)

ADD_TEST(NAME dll COMMAND test-main dll $<TARGET_FILE:module>)

ADD_TEST(ipso:main   test-main  ipso)
ADD_TEST(ipso:io     test-main  ipso_io)
ADD_TEST(ipso:gh     test-main  ipso_gh)
ADD_TEST(ipso:dct    test-main  ipso_dct)
ADD_TEST(ipso:c2d    test-main  ipso_c2d)

ADD_TEST(Lang:Token    test-main  token)
ADD_TEST(Lang:Source   test-main  source NULL)
ADD_TEST(Lang:Pattern  test-main  pattern)
ADD_TEST(Lang:Posix    test-main  posix)
ADD_TEST(Lang:RegEx    test-main  regex)
ADD_TEST(Lang:Matching test-main  matching)
ADD_TEST(Lang:Scanner  test-main scanner NULL)
ADD_TEST(Lang:Lex      test-main lex     NULL)

ADD_TEST(geom:iso2d test-main geom_iso2d)
ADD_TEST(uuid       test-main uuid)

ADD_CUSTOM_TARGET(utest-main
COMMAND ${CMAKE_CTEST_COMMAND} -V
DEPENDS test-main)
